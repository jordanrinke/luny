purpose: This module implements the validate command that checks .toon files for correctness and consistency with their source files. It verifies exports match, token counts are within limits, and required fields are present.
tokens: ~5957
exports[1]: run_validate(fn)
signatures[1]:
  run_validate(fn): (args: &ValidateArgs, root: &Path, verbose: bool) Result<()>
imports[14]{from,items}: crate::cli,ValidateArgs; crate::config,Config|ThresholdMatcher; crate::exclusion,build_exclude_globset|build_walker; crate::formatter,format_toon|parse_toon; crate::parser,ParserFactory; crate::types,ToonData|ValidationResult; anyhow,Context|Result; std,fs; std::path,Path|PathBuf; super::*,super::*; std,fs; tempfile,TempDir; crate::config,TokenConfig; crate::config,TokenConfig
calls[6]{target,methods}: std,create_dir_all(&src_nested).unwrap|write(temp_dir.path().join(".ai/missing.ts.toon"), toon_content).unwrap|create_dir_all(&ai_src).unwrap|read_to_string|create_dir(temp_dir.path().join("lib")).unwrap|create_dir_all(parent).context|create_dir_all|read_to_string(toon_path).context|write(toon_path, content).context|create_dir|write(temp_dir.path().join("test.ts"), "export const x = 1;").unwrap|create_dir_all(&ai_lib).unwrap|create_dir_all(&ai_nested).unwrap|write(temp_dir.path().join("lib/utils.ts"), "export const y = 2;").unwrap|write(src_nested.join("Button.tsx"), "export function Button() {}").unwrap|write(ai_nested.join("Button.tsx.toon"), toon_content).unwrap|write(ai_src.join("main.ts.toon"), toon_content).unwrap|write(temp_dir.path().join(".ai/test.ts.toon"), toon_content).unwrap|create_dir(temp_dir.path().join("src")).unwrap|create_dir(temp_dir.path().join(".ai")).unwrap|read_to_string(&source_path).context|write(temp_dir.path().join("test.ts"), source).unwrap|write(temp_dir.path().join("src/main.ts"), "export const x = 1;").unwrap|write(
            ai_lib.join("missing.ts.toon"),
            "purpose: Missing\ntokens: ~50\nexports[0]:",
        )
        .unwrap|write; crate::parser,new; crate::cli,default; crate::types,new; tempfile,new().unwrap|new; crate::config,new|load|default
